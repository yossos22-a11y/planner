<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>원형 실시간 계획표</title>

<style>
:root{ --size: min(90vw, 380px); }
*{ box-sizing:border-box; }

body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  font-family: system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
  background:#fff;
  padding-top: env(safe-area-inset-top);
}

.wrap{ width:100%; max-width:560px; padding:16px; }
.card{
  border:1px solid #eee;
  border-radius:18px;
  padding:14px;
  box-shadow:0 6px 20px rgba(0,0,0,.06);
}

.topBig{
  text-align:center;
  margin-bottom:12px;
  font-weight:900;
  font-size:clamp(18px,5vw,28px);
  font-variant-numeric: tabular-nums;
}

.dial{ width:var(--size); height:var(--size); margin:0 auto; }
svg{ width:100%; height:100%; display:block; }

.timerBox{
  margin-top:14px;
  border:1px solid #eee;
  border-radius:16px;
  padding:12px;
  display:grid;
  gap:10px;
}
.timerTop{
  display:flex;
  justify-content:space-between;
  align-items:baseline;
}
.timerDisplay{
  font-weight:900;
  font-size:28px;
  font-variant-numeric: tabular-nums;
}
.progress{
  height:10px;
  border-radius:999px;
  background:#f1f1f1;
  overflow:hidden;
}
.progress>div{height:100%;width:0%;background:#000;}

.timerControls{
  display:flex;
  justify-content:space-between;
  gap:10px;
  flex-wrap:wrap;
}
.field{display:flex;gap:6px;align-items:center;}
.field label{font-weight:800;}
.field input{
  width:70px;
  padding:8px;
  border-radius:12px;
  border:1px solid #ddd;
  font-weight:900;
}
button{
  padding:10px 12px;
  border-radius:14px;
  border:1px solid #ddd;
  background:#fff;
  font-weight:900;
}
button.primary{border-color:#000;}
</style>
</head>

<body>
<div class="wrap">
<div class="card">

<div class="topBig" id="topDateTime">----</div>

<div class="dial">
<svg viewBox="-6 -6 112 112">

<g id="hours"></g>
<circle cx="50" cy="50" r="40" fill="none" stroke="#eee" stroke-width="12"/>
<g id="arcs"></g>
<g id="labels"></g>

<line id="hand" x1="50" y1="50" x2="50" y2="12" stroke="#000" stroke-width="0.9"/>
<polygon id="arrow" points="0,-2 -1.6,1.6 1.6,1.6" fill="#000"/>

<g id="centerInfo">
  <circle cx="50" cy="50" r="18" fill="#fff" opacity="0.95"/>
  <circle cx="50" cy="50" r="2.2" fill="#fff"/>

  <text id="centerLabel" x="50" y="41.5" text-anchor="middle" font-size="5.6" font-weight="900">-</text>
  <text id="centerRange" x="50" y="48.8" text-anchor="middle" font-size="5.0" font-weight="800">--:--~--:--</text>
  <text id="centerRemain" x="50" y="56.2" text-anchor="middle" font-size="3.9" fill="#555"></text>
  <text id="centerToSleep" x="50" y="61.9" text-anchor="middle" font-size="3.6" fill="#777"></text>
</g>

</svg>
</div>

<div class="timerBox">
  <div class="timerTop">
    <div>타이머</div>
    <div class="timerDisplay" id="timerDisplay">00:25:00</div>
  </div>
  <div class="progress"><div id="timerBar"></div></div>
  <div class="timerControls">
    <div style="display:flex;gap:10px;">
      <div class="field"><label>시</label><input id="timerHours" type="number" value="0"></div>
      <div class="field"><label>분</label><input id="timerMinutes" type="number" value="25"></div>
    </div>
    <div style="display:flex;gap:8px;">
      <button class="primary" id="btnStart">시작</button>
      <button id="btnPause">정지</button>
      <button id="btnReset">리셋</button>
    </div>
  </div>
</div>

</div>
</div>

<script>
/* ===== 스케줄 ===== */
const SEGMENTS=[
  {start:"05:00",end:"05:30",label:"기상",color:"#FF8A00"},
  {start:"05:30",end:"06:30",label:"공부",color:"#5BC0FF"},
  {start:"06:30",end:"09:30",label:"육아/가사",color:"#FFD400"},
  {start:"09:30",end:"11:00",label:"공부",color:"#5BC0FF"},
  {start:"11:00",end:"13:30",label:"육아/가사",color:"#FFD400"},
  {start:"13:30",end:"15:00",label:"공부",color:"#5BC0FF"},
  {start:"15:00",end:"21:00",label:"육아/가사",color:"#FFD400"},
  {start:"21:00",end:"22:00",label:"취침준비",color:"#0B2A6F"},
  {start:"22:00",end:"05:00",label:"수면",color:"#7A3FF2"},
];
const SLEEP_START="22:00";
const DOW=["일","월","화","수","목","금","토"];
const R=40;

const toMin=t=>{const[a,b]=t.split(":").map(Number);return a*60+b;}
const pad=n=>String(n).padStart(2,"0");
const fracToRad=f=>f*2*Math.PI-Math.PI/2;

function build(){
  for(let h=1;h<=24;h++){
    const a=fracToRad(h/24);
    hours.innerHTML+=`<text x="${50+50*Math.cos(a)}" y="${50+50*Math.sin(a)}"
      text-anchor="middle" dominant-baseline="middle" font-size="3.2">${h}</text>`;
  }
  SEGMENTS.forEach(s=>{
    const a=toMin(s.start)/1440,b=toMin(s.end)/1440;
    arcs.innerHTML+=`<path d="${arc(a,b>a?b:1)}" stroke="${s.color}" stroke-width="14" fill="none"/>`;
    if(b<a) arcs.innerHTML+=`<path d="${arc(0,b)}" stroke="${s.color}" stroke-width="14" fill="none"/>`;
  });
}
function arc(s,e){
  const a0=fracToRad(s),a1=fracToRad(e);
  return `M ${50+R*Math.cos(a0)} ${50+R*Math.sin(a0)}
          A ${R} ${R} 0 0 1 ${50+R*Math.cos(a1)} ${50+R*Math.sin(a1)}`;
}

function update(){
  const n=new Date();
  topDateTime.textContent=
    `${n.getFullYear()}-${pad(n.getMonth()+1)}-${pad(n.getDate())} ${DOW[n.getDay()]} ${pad(n.getHours())}:${pad(n.getMinutes())}:${pad(n.getSeconds())}`;

  const now=n.getHours()*60+n.getMinutes();
  const seg=SEGMENTS.find(s=>{
    const a=toMin(s.start),b=toMin(s.end);
    return b>a? now>=a&&now<b : now>=a||now<b;
  });

  if(seg){
    centerLabel.textContent=seg.label;
    centerRange.textContent=`${seg.start}~${seg.end}`;
    let r=toMin(seg.end)-now; if(r<0) r+=1440;
    centerRemain.textContent=`남은 시간 ${Math.floor(r/60)}시간 ${r%60}분`;
    let rs=toMin(SLEEP_START)-now; if(rs<0) rs+=1440;
    centerToSleep.textContent=`22:00까지 ${Math.floor(rs/60)}시간 ${rs%60}분`;
  }

  const f=(n.getHours()*3600+n.getMinutes()*60+n.getSeconds())/86400;
  const ang=fracToRad(f);
  hand.setAttribute("x2",50+(R-2)*Math.cos(ang));
  hand.setAttribute("y2",50+(R-2)*Math.sin(ang));
  arrow.setAttribute("transform",`translate(${50+(R-2)*Math.cos(ang)} ${50+(R-2)*Math.sin(ang)}) rotate(${ang*180/Math.PI+90})`);

  requestAnimationFrame(update);
}

/* ===== 수동 타이머 ===== */
let dur=25*60000,rem=dur,run=false,last=0;
function sync(){
  timerDisplay.textContent=
    `${pad(Math.floor(rem/3600000))}:${pad(Math.floor(rem%3600000/60000))}:${pad(Math.floor(rem%60000/1000))}`;
  timerBar.style.width=`${100*(1-rem/dur)}%`;
}
function apply(){
  dur=(+timerHours.value*3600+ +timerMinutes.value*60)*1000||1000;
  rem=dur; run=false; last=0; sync();
}
btnStart.onclick=()=>{run=true; last=performance.now();}
btnPause.onclick=()=>run=false;
btnReset.onclick=apply;
timerHours.oninput=timerMinutes.oninput=apply;

function tick(){
  if(run){
    const now=performance.now();
    if(last){rem-=now-last;if(rem<=0){rem=0;run=false;}}
    last=now; sync();
  }
  requestAnimationFrame(tick);
}

build(); apply(); update(); tick();
</script>
</body>
</html>
