<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>원형 실시간 계획표</title>

<style>
:root{ --size: min(90vw, 380px); }
*{ box-sizing:border-box; }

body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  font-family: system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
  background:#fff;
  padding-top: env(safe-area-inset-top);
}

.wrap{ width:100%; max-width:560px; padding:16px; }

.card{
  border:1px solid #eee;
  border-radius:18px;
  padding:14px;
  box-shadow:0 6px 20px rgba(0,0,0,.06);
}

/* 상단 날짜/시간 */
.topBig{
  display:flex;
  justify-content:center;
  align-items:center;
  margin-bottom:12px;
}
.topBig span{
  font-weight:900;
  font-size:clamp(18px, 5vw, 28px);
  color:#000;
  font-variant-numeric: tabular-nums;
  white-space:nowrap;
}

/* 원형 */
.dial{ width:var(--size); height:var(--size); margin:0 auto; }
svg{ width:100%; height:100%; display:block; }

/* 하단 수동 타이머 */
.timerBox{
  margin-top:14px;
  border:1px solid #f0f0f0;
  border-radius:16px;
  padding:12px;
  display:grid;
  gap:10px;
}
.timerTop{
  display:flex;
  justify-content:space-between;
  align-items:baseline;
}
.timerTitle{ font-weight:900; font-size:16px; }
.timerDisplay{
  font-weight:900;
  font-size:28px;
  font-variant-numeric: tabular-nums;
}
.progress{
  height:10px;
  border-radius:999px;
  background:#f1f1f1;
  overflow:hidden;
}
.progress > div{ height:100%; width:0%; background:#000; }

.timerControls{
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap:10px;
  flex-wrap:wrap;
}
.field{ display:flex; gap:6px; align-items:center; }
.field label{ font-weight:800; font-size:14px; }
.field input{
  width:70px;
  padding:8px 10px;
  border:1px solid #e5e5e5;
  border-radius:12px;
  font-weight:900;
}
.btns{ display:flex; gap:8px; }
button{
  border:1px solid #e5e5e5;
  background:#fff;
  padding:10px 12px;
  border-radius:14px;
  font-weight:900;
  cursor:pointer;
}
button.primary{ border-color:#000; }
</style>
</head>

<body>
<div class="wrap">
<div class="card">

  <div class="topBig">
    <span id="topDateTime">----</span>
  </div>

  <div class="dial">
    <svg viewBox="-6 -6 112 112">

      <g id="hours"></g>

      <circle cx="50" cy="50" r="40"
        fill="none" stroke="#e7e7e7" stroke-width="12"/>

      <g id="arcs"></g>
      <g id="labels"></g>

      <line id="hand" x1="50" y1="50" x2="50" y2="12"
        stroke="#000" stroke-width="0.9"/>

      <polygon id="arrow"
        points="0,-2 -1.6,1.6 1.6,1.6"
        fill="#000"/>

      <!-- 중앙 정보 -->
      <g id="centerInfo">
        <circle cx="50" cy="50" r="18" fill="#fff" opacity="0.95"/>
        <circle cx="50" cy="50" r="2.2" fill="#fff"/>

        <text id="centerLabel" x="50" y="41.5"
          text-anchor="middle" fill="#000"
          font-size="5.6" font-weight="900">-</text>

        <text id="centerRange" x="50" y="48.8"
          text-anchor="middle" fill="#000"
          font-size="5.0" font-weight="800"
          style="font-variant-numeric:tabular-nums">--:--~--:--</text>

        <text id="centerRemain" x="50" y="56.2"
          text-anchor="middle" fill="#555"
          font-size="3.9" font-weight="700"></text>

        <text id="centerToSleep" x="50" y="61.9"
          text-anchor="middle" fill="#777"
          font-size="3.6" font-weight="700"></text>
      </g>

    </svg>
  </div>

  <!-- 하단 수동 타이머 -->
  <div class="timerBox">
    <div class="timerTop">
      <div class="timerTitle">타이머</div>
      <div class="timerDisplay" id="timerDisplay">00:25:00</div>
    </div>

    <div class="progress"><div id="timerBar"></div></div>

    <div class="timerControls">
      <div style="display:flex; gap:10px;">
        <div class="field">
          <label>시</label>
          <input id="timerHours" type="number" min="0" max="99" value="0">
        </div>
        <div class="field">
          <label>분</label>
          <input id="timerMinutes" type="number" min="0" max="59" value="25">
        </div>
      </div>
      <div class="btns">
        <button class="primary" id="btnStart">시작</button>
        <button id="btnPause">정지</button>
        <button id="btnReset">리셋</button>
      </div>
    </div>
  </div>

</div>
</div>

<script>
/* ===== 하단 수동 타이머 (정상 동작) ===== */
let duration = 25 * 60 * 1000;
let remaining = duration;
let running = false;
let lastTick = 0;

const tDisp = document.getElementById("timerDisplay");
const tBar  = document.getElementById("timerBar");
const hIn   = document.getElementById("timerHours");
const mIn   = document.getElementById("timerMinutes");

function pad(n){ return String(n).padStart(2,"0"); }

function format(ms){
  const s = Math.max(0, Math.floor(ms/1000));
  return `${pad(Math.floor(s/3600))}:${pad(Math.floor(s%3600/60))}:${pad(s%60)}`;
}

function sync(){
  tDisp.textContent = format(remaining);
  tBar.style.width = `${100*(1-remaining/duration)}%`;
}

function apply(){
  duration = (+hIn.value*3600 + +mIn.value*60) * 1000;
  if(duration <= 0) duration = 1000;
  remaining = duration;
  running = false;
  lastTick = 0;
  sync();
}

document.getElementById("btnStart").onclick = () => {
  running = true;
  lastTick = performance.now();
};
document.getElementById("btnPause").onclick = () => running = false;
document.getElementById("btnReset").onclick = apply;

hIn.oninput = mIn.oninput = apply;

function tick(){
  if(running){
    const now = performance.now();
    if(lastTick){
      remaining -= now - lastTick;
      if(remaining <= 0){
        remaining = 0;
        running = false;
      }
    }
    lastTick = now;
    sync();
  }
  requestAnimationFrame(tick);
}

apply();
tick();
</script>
</body>
</html>
